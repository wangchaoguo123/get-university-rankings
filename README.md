```# 上海软科大学排名爬虫

## 简介

这是一个用于爬取上海软科教育信息咨询有限公司发布的各类大学排名数据的Python脚本。程序可以自动从shanghairanking.cn网站获取中国大学排名、中国高职院校排名、世界大学学术排名等多个排名榜单的历史数据（最近三年），并将结果保存到Excel文件中。

主要功能包括：
- 支持多种排名类型的爬取
- 自动翻页获取完整的排名数据
- 数据清洗和结构化处理
- 按年份保存到不同的Excel工作表
- 完善的日志记录系统

## 安装

### 依赖库

在运行程序前，请确保已安装以下Python库：

bash
pip install beautifulsoup4 selenium pandas openpyxl lxml
```

此外，还需要安装浏览器驱动程序：
- Microsoft Edge (推荐) 或 Google Chrome
- 对应的WebDriver（msedgedriver或chromedriver）

### 环境配置

1. 确保已安装最新版的Edge或Chrome浏览器
2. 下载对应的WebDriver并将其路径添加到系统PATH环境变量中
3. 创建项目目录结构，程序会自动创建`logs`和`output`目录

## 使用方法

1. 运行主程序：
```bash
python main.py
```

2. 根据提示输入要爬取的排名类型（输入数字1-7）：
   - 1. 中国大学排名
   - 2. 中国高职院校排名
   - 3. 世界大学学术排名
   - 4. 中国最好学科排名（暂未完全支持）
   - 5. 中国大学专业排名（暂未完全支持）
   - 6. 世界一流学科排名（暂未完全支持）
   - 7. 全球体育类院系学术排名（暂未完全支持）

3. 程序将自动爬取最近三年的数据并保存到output目录下的Excel文件中

## 示例

### 示例1：爬取中国大学排名
```bash
$ python main.py
请输入排名类型：
        1.中国大学排名
        2.中国高职院校排名
        3.世界大学学术排名
        4.中国最好学科排名(未使用)
        5.中国大学专业排名(未使用)
        6.世界一流学科排名(未使用)
        7.全球体育类院系学术排名(未使用)
        请输入对应数字（默认1）: 1
```

程序将爬取2022、2023、2024年的中国大学排名数据，并保存为`中国大学排名_2022-2024.xlsx`文件，其中每个年份对应一个工作表。

### 示例2：爬取世界大学学术排名
```bash
$ python main.py
请输入排名类型：
        1.中国大学排名
        2.中国高职院校排名
        3.世界大学学术排名
        ...
        请输入对应数字（默认1）: 3
```

程序将爬取最近三年的世界大学学术排名数据，并保存为`世界大学学术排名_2022-2024.xlsx`文件。

## 日志系统

程序会自动创建日志文件，存储在`logs`目录下，文件名为`Logging_YYYYMMDD.log`。日志级别可通过环境变量`LOG_LEVEL`控制（默认为INFO级别）。

## 错误处理

程序具备完善的错误处理机制：
- 自动检测并切换浏览器（Edge或Chrome）
- 处理页面加载失败的情况
- 数据解析异常的捕获和记录
- 网络请求超时处理

## 贡献指南

欢迎提交Issue和Pull Request来改进此项目：

1. Fork项目
2. 创建功能分支
3. 提交更改
4. 发起Pull Request

在提交代码前，请确保：
- 代码风格符合PEP 8标准
- 添加适当的单元测试
- 更新相关的文档

## 许可证

本项目采用MIT许可证。详情请参见LICENSE文件。

## 注意事项

- 请遵守网站的robots.txt协议和使用条款
- 不要过于频繁地请求数据，避免对服务器造成压力
- 爬取的数据仅供个人学习和研究使用
- 如网站结构发生变化，可能需要更新解析代码
``````